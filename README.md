# Whalgebra

> **高精度 Web 复数计算引擎**

Whalgebra 是一个基于原生 Web 技术开发的高性能数学计算引擎和图形化计算器。它旨在提供超越标准 JavaScript `Number` 限制（64位浮点数）的高精度计算能力，并完整支持复数域的数学运算，同时包含函数列表，多项式函数分析，统计计算等许多拓展功能。

## 🌟 核心特性

### 1. 高精度大数运算 (BigNumber，ComplexNumber)

- **精度可控**：突破 JS 浮点数 16 位有效数字的限制，支持自定义精度的数值运算。
- **一致性**：核心算法确保在进行加、减、乘、除等基础运算时保持极高的数值稳定性。

### 2. 全功能复数域支持

- **复数算法**：支持 `a + bi` 和 `r ∠ θ` 形式的复数运算。
- **全面覆盖**：不仅支持复数基础算术，还支持复数幂、复数三角函数、复数对数、复数阶乘（即伽马函数）及复合函数运算。

### 3. 智能表达式解析器

- **核心算法**：基于改进的 **调度场算法 (Shunting-yard Algorithm)** 实现。
- **人性化设计**：
  - **隐式乘法**：自动识别如 `2[pi]`, `5(2+3)`, `isin([pi])` 等输入。
  - **语法容错**：智能补全末尾缺失的括号。
  - **符号化处理**：内置 `pi`, `e`, `i` 等数学常数。

### 4. 丰富的数学函数库

- **基础函数**：加，减，乘，除，`sqrt`，` cbrt`，`nroot` 等。
- **超越函数**：`exp`，` ln`，`log` 等。
- **三角函数**：支持弧度 (Rad) 与角度 (Deg) 模式切换，包含 `sin`，`cos`，`tan`，`arcsin`，`arccos`，`arctan`。
- **双曲函数**：包含 `sh`，`ch`，`th`，`arsh`，`arch`，`arth`。
- **特殊运算**：高精度阶乘 (`!`)、绝对值 (`abs`)、取整函数等。

### 5. 零依赖
- 纯 Vanilla JavaScript 实现，无需安装 Node.js 和任何第三方库。

### 6.单文件集成
- 项目采用了典型的 “单文件 Web 应用” 结构，将 HTML 结构、复杂的 CSS 样式和 JavaScript 逻辑全部集成在一个 .html 文件中。这种做法非常便于分发和离线使用。

## 🚀 快速开始

### 运行环境

- **兼容性**：支持所有现代浏览器（Chrome, Edge, Firefox, Safari）。
- **零依赖**：无需安装 Node.js 或任何第三方库。

### 使用方法

#### 1.通过浏览器运行
1. 克隆或下载本仓库。
2. 直接双击 src 目录下的 `Whalgebra.html` 即可在浏览器中启动。
#### 2.通过应用运行
下载 Releases 中的 .apk 文件并安装即可在安卓系统中使用。

### 开发者接口示例

您可以在控制台中直接调用核心计算类进行二次开发：

```JavaScript
// 1. 简单计算
const [res1] = MathPlus.calc("2^10 + 24");
console.log(res1.toString()); // "1048"

// 2. 复数与三角函数结合
const [res2] = MathPlus.calc("sin([pi]/4 + [i])");
console.log(res2.toString()); // 输出复数结果

// 3. 高精度阶乘
const [res3] = MathPlus.calc("100!");
console.log(res3.toString()); // 输出 100 的精确阶乘结果
```

## ⌨️ 键盘快捷键与交互示例

为了提高输入效率，计算器支持以下键盘映射：

| 键盘按键     | 功能说明                |
| :---------: | :---------------------: |
| `Enter`     | 执行计算 (=)            |
| `Backspace` | 删除光标前的一个字符 |
| `Delete`    | 删除光标后的一个字符 |
| `^`         | 幂运算 (x^y)            |
| `alt` + `e` | 快捷输入自然对数底数（e）|
| `alt` + `i` | 快捷输入虚数单位（i）  |

## 🛠 技术解析

- **数据结构**：项目放弃了原生 `Number`，采用自定义对象维护数值位，确保在大数运算下不丢失精度。
- **解析流程**：输入字符串 -> 符号化 (Tokenization) -> 预处理 (补全乘号/括号) -> 逆波兰表达式 (RPN) -> 栈式求值。
- **近似算法**：对于初等函数，使用参数缩减和泰勒展开近似算法；对于阶乘和 Gamma 函数，内部集成了多组 **Lanczos 近似** 参数 （[参数详细信息](https://github.com/Double-Cloth/LanczosApproximation)）以平衡计算速度与精度。
- **图形界面**：包含完整清晰的交互界面，同时使用 svg 作为字体和图片，保证了在不同设备上显示效果相同。

## 📄 许可证

本项目基于 **MIT 许可证** 开源。

**作者**: DoubleCloth [Contact me](mailto:Double-Cloth@outlook.com)

**项目地址**: [GitHub - Whalgebra](https://github.com/Double-Cloth/Whalgebra)
